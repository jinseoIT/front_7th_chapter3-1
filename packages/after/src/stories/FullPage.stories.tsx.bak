import type { Meta, StoryObj } from "@storybook/react";
import { fn } from "@storybook/test";
import { Header, Alert, Modal, Table, ButtonCustom as Button, Badge, FormInput } from "../shared/ui";
import { Card } from "../shared/ui/card";
import { useState } from "react";

const meta = {
  title: "Pages/FullPage",
  parameters: {
    layout: "fullscreen",
  },
  tags: ["autodocs"],
} satisfies Meta;

export default meta;
type Story = StoryObj<typeof meta>;

// 샘플 데이터
const samplePosts = [
  {
    id: 1,
    title: "React 19 새로운 기능 소개",
    category: "development",
    status: "published",
    views: 1234,
    author: "김개발",
    createdAt: "2024-01-15",
  },
  {
    id: 2,
    title: "UI/UX 디자인 시스템 구축하기",
    category: "design",
    status: "published",
    views: 856,
    author: "이디자인",
    createdAt: "2024-01-14",
  },
  {
    id: 3,
    title: "웹 접근성 가이드라인",
    category: "accessibility",
    status: "draft",
    views: 0,
    author: "박접근성",
    createdAt: "2024-01-13",
  },
  {
    id: 4,
    title: "TypeScript 고급 타입 활용",
    category: "development",
    status: "published",
    views: 2341,
    author: "최타입",
    createdAt: "2024-01-12",
  },
  {
    id: 5,
    title: "Storybook 활용 가이드",
    category: "development",
    status: "archived",
    views: 445,
    author: "정스토리",
    createdAt: "2024-01-11",
  },
];

const sampleUsers = [
  {
    id: 1,
    name: "김관리자",
    email: "admin@example.com",
    role: "admin",
    status: "active",
    lastLogin: "2024-01-20 10:30",
  },
  {
    id: 2,
    name: "이운영자",
    email: "moderator@example.com",
    role: "moderator",
    status: "active",
    lastLogin: "2024-01-20 09:15",
  },
  {
    id: 3,
    name: "박사용자",
    email: "user@example.com",
    role: "user",
    status: "active",
    lastLogin: "2024-01-19 15:45",
  },
  {
    id: 4,
    name: "최게스트",
    email: "guest@example.com",
    role: "guest",
    status: "inactive",
    lastLogin: "2024-01-10 12:00",
  },
];

// 게시글 관리 페이지
export const PostManagementPage: Story = {
  render: () => {
    const [showModal, setShowModal] = useState(false);

    return (
      <div style={{ minHeight: "100vh", backgroundColor: "#f7fafc" }}>
        <Header />

        <main style={{ maxWidth: "1400px", margin: "0 auto", padding: "24px" }}>
          {/* 페이지 헤더 */}
          <div style={{ marginBottom: "24px" }}>
            <h1 style={{ fontSize: "28px", fontWeight: "700", color: "#1a202c", marginBottom: "8px" }}>게시글 관리</h1>
            <p style={{ color: "#718096", fontSize: "14px" }}>모든 게시글을 관리하고 상태를 변경할 수 있습니다</p>
          </div>

          {/* 알림 */}
          <div style={{ marginBottom: "24px" }}>
            <Alert variant="info" title="새로운 게시글">
              3개의 게시글이 검토 대기 중입니다.
            </Alert>
          </div>

          {/* 통계 카드 */}
          <div
            style={{
              display: "grid",
              gridTemplateColumns: "repeat(auto-fit, minmax(250px, 1fr))",
              gap: "16px",
              marginBottom: "24px",
            }}
          >
            <Card variant="elevated">
              <div style={{ textAlign: "center" }}>
                <div style={{ fontSize: "32px", fontWeight: "700", color: "#007bff", marginBottom: "8px" }}>
                  {samplePosts.length}
                </div>
                <div style={{ fontSize: "14px", color: "#718096" }}>전체 게시글</div>
              </div>
            </Card>

            <Card variant="elevated">
              <div style={{ textAlign: "center" }}>
                <div style={{ fontSize: "32px", fontWeight: "700", color: "#28a745", marginBottom: "8px" }}>
                  {samplePosts.filter((p) => p.status === "published").length}
                </div>
                <div style={{ fontSize: "14px", color: "#718096" }}>게시됨</div>
              </div>
            </Card>

            <Card variant="elevated">
              <div style={{ textAlign: "center" }}>
                <div style={{ fontSize: "32px", fontWeight: "700", color: "#ffc107", marginBottom: "8px" }}>
                  {samplePosts.filter((p) => p.status === "draft").length}
                </div>
                <div style={{ fontSize: "14px", color: "#718096" }}>임시저장</div>
              </div>
            </Card>

            <Card variant="elevated">
              <div style={{ textAlign: "center" }}>
                <div style={{ fontSize: "32px", fontWeight: "700", color: "#6c757d", marginBottom: "8px" }}>
                  {samplePosts.filter((p) => p.status === "archived").length}
                </div>
                <div style={{ fontSize: "14px", color: "#718096" }}>보관됨</div>
              </div>
            </Card>
          </div>

          {/* 게시글 테이블 */}
          <Card
            variant="elevated"
            title="게시글 목록"
            headerActions={
              <Button variant="primary" onClick={() => setShowModal(true)}>
                새 게시글 작성
              </Button>
            }
          >
            <Table
              columns={[
                { key: "id", header: "ID", width: "60px" },
                { key: "title", header: "제목" },
                { key: "category", header: "카테고리", width: "120px" },
                { key: "status", header: "상태", width: "100px" },
                { key: "views", header: "조회수", width: "100px" },
                { key: "author", header: "작성자", width: "120px" },
                { key: "createdAt", header: "작성일", width: "120px" },
                { key: "actions", header: "작업", width: "280px" },
              ]}
              data={samplePosts}
              entityType="post"
              striped
              hover
              searchable
              sortable
              pageSize={5}
              onEdit={fn()}
              onDelete={fn()}
              onPublish={fn()}
              onArchive={fn()}
              onRestore={fn()}
            />
          </Card>
        </main>

        {/* 모달 */}
        {showModal && (
          <Modal isOpen={showModal} onClose={() => setShowModal(false)} title="새 게시글 작성" size="lg">
            <div style={{ display: "flex", flexDirection: "column", gap: "16px" }}>
              <FormInput label="제목" placeholder="게시글 제목을 입력하세요" required />
              <FormInput label="카테고리" placeholder="카테고리를 선택하세요" />
              <div style={{ display: "flex", gap: "8px", justifyContent: "flex-end", marginTop: "16px" }}>
                <Button variant="secondary" onClick={() => setShowModal(false)}>
                  취소
                </Button>
                <Button variant="primary" onClick={() => setShowModal(false)}>
                  작성
                </Button>
              </div>
            </div>
          </Modal>
        )}
      </div>
    );
  },
  parameters: {
    docs: {
      description: {
        story:
          "게시글을 관리하는 전체 페이지 예제입니다. Header, Card, Table, Alert, Modal 등 여러 컴포넌트가 조합되어 있습니다.",
      },
    },
  },
};

// 사용자 관리 페이지
export const UserManagementPage: Story = {
  render: () => (
    <div style={{ minHeight: "100vh", backgroundColor: "#f7fafc" }}>
      <Header />

      <main style={{ maxWidth: "1400px", margin: "0 auto", padding: "24px" }}>
        <div style={{ marginBottom: "24px" }}>
          <h1 style={{ fontSize: "28px", fontWeight: "700", color: "#1a202c", marginBottom: "8px" }}>사용자 관리</h1>
          <p style={{ color: "#718096", fontSize: "14px" }}>시스템 사용자를 관리하고 권한을 설정할 수 있습니다</p>
        </div>

        <div style={{ marginBottom: "24px" }}>
          <Alert variant="success" title="시스템 정상">
            모든 사용자가 정상적으로 활동 중입니다.
          </Alert>
        </div>

        <div
          style={{
            display: "grid",
            gridTemplateColumns: "repeat(auto-fit, minmax(200px, 1fr))",
            gap: "16px",
            marginBottom: "24px",
          }}
        >
          <Card variant="bordered">
            <div style={{ display: "flex", alignItems: "center", gap: "12px" }}>
              <Badge userRole="admin" size="large" />
              <div>
                <div style={{ fontSize: "24px", fontWeight: "700", color: "#1a202c" }}>1</div>
                <div style={{ fontSize: "12px", color: "#718096" }}>관리자</div>
              </div>
            </div>
          </Card>

          <Card variant="bordered">
            <div style={{ display: "flex", alignItems: "center", gap: "12px" }}>
              <Badge userRole="moderator" size="large" />
              <div>
                <div style={{ fontSize: "24px", fontWeight: "700", color: "#1a202c" }}>1</div>
                <div style={{ fontSize: "12px", color: "#718096" }}>운영자</div>
              </div>
            </div>
          </Card>

          <Card variant="bordered">
            <div style={{ display: "flex", alignItems: "center", gap: "12px" }}>
              <Badge userRole="user" size="large" />
              <div>
                <div style={{ fontSize: "24px", fontWeight: "700", color: "#1a202c" }}>1</div>
                <div style={{ fontSize: "12px", color: "#718096" }}>사용자</div>
              </div>
            </div>
          </Card>

          <Card variant="bordered">
            <div style={{ display: "flex", alignItems: "center", gap: "12px" }}>
              <Badge userRole="guest" size="large" />
              <div>
                <div style={{ fontSize: "24px", fontWeight: "700", color: "#1a202c" }}>1</div>
                <div style={{ fontSize: "12px", color: "#718096" }}>게스트</div>
              </div>
            </div>
          </Card>
        </div>

        <Card variant="elevated" title="사용자 목록" headerActions={<Button variant="primary">새 사용자 추가</Button>}>
          <Table
            columns={[
              { key: "id", header: "ID", width: "60px" },
              { key: "name", header: "이름", width: "150px" },
              { key: "email", header: "이메일" },
              { key: "role", header: "역할", width: "100px" },
              { key: "status", header: "상태", width: "100px" },
              { key: "lastLogin", header: "마지막 로그인", width: "180px" },
              { key: "actions", header: "작업", width: "150px" },
            ]}
            data={sampleUsers}
            entityType="user"
            striped
            hover
            searchable
            sortable
            onEdit={fn()}
            onDelete={fn()}
          />
        </Card>
      </main>
    </div>
  ),
  parameters: {
    docs: {
      description: {
        story: "사용자를 관리하는 전체 페이지 예제입니다. 역할별 통계와 사용자 목록이 표시됩니다.",
      },
    },
  },
};

// 대시보드 페이지
export const DashboardPage: Story = {
  render: () => (
    <div style={{ minHeight: "100vh", backgroundColor: "#f7fafc" }}>
      <Header />

      <main style={{ maxWidth: "1400px", margin: "0 auto", padding: "24px" }}>
        <div style={{ marginBottom: "24px" }}>
          <h1 style={{ fontSize: "28px", fontWeight: "700", color: "#1a202c", marginBottom: "8px" }}>대시보드</h1>
          <p style={{ color: "#718096", fontSize: "14px" }}>시스템 현황을 한눈에 확인할 수 있습니다</p>
        </div>

        <div
          style={{
            display: "grid",
            gridTemplateColumns: "repeat(auto-fit, minmax(300px, 1fr))",
            gap: "24px",
            marginBottom: "24px",
          }}
        >
          <Card title="최근 활동" variant="elevated">
            <div style={{ display: "flex", flexDirection: "column", gap: "12px" }}>
              <div
                style={{
                  display: "flex",
                  alignItems: "center",
                  gap: "8px",
                  padding: "8px",
                  borderLeft: "3px solid #007bff",
                }}
              >
                <Badge type="primary" size="small">
                  NEW
                </Badge>
                <div style={{ flex: 1, fontSize: "14px" }}>새로운 게시글이 작성되었습니다</div>
                <div style={{ fontSize: "12px", color: "#718096" }}>5분 전</div>
              </div>
              <div
                style={{
                  display: "flex",
                  alignItems: "center",
                  gap: "8px",
                  padding: "8px",
                  borderLeft: "3px solid #28a745",
                }}
              >
                <Badge type="success" size="small">
                  SUCCESS
                </Badge>
                <div style={{ flex: 1, fontSize: "14px" }}>게시글이 게시되었습니다</div>
                <div style={{ fontSize: "12px", color: "#718096" }}>1시간 전</div>
              </div>
              <div
                style={{
                  display: "flex",
                  alignItems: "center",
                  gap: "8px",
                  padding: "8px",
                  borderLeft: "3px solid #ffc107",
                }}
              >
                <Badge type="warning" size="small">
                  WARNING
                </Badge>
                <div style={{ flex: 1, fontSize: "14px" }}>검토가 필요한 게시글이 있습니다</div>
                <div style={{ fontSize: "12px", color: "#718096" }}>2시간 전</div>
              </div>
            </div>
          </Card>

          <Card title="시스템 상태" variant="elevated">
            <div style={{ display: "flex", flexDirection: "column", gap: "16px" }}>
              <div>
                <div style={{ display: "flex", justifyContent: "space-between", marginBottom: "8px" }}>
                  <span style={{ fontSize: "14px", color: "#718096" }}>서버 상태</span>
                  <Badge type="success">정상</Badge>
                </div>
                <div style={{ display: "flex", justifyContent: "space-between", marginBottom: "8px" }}>
                  <span style={{ fontSize: "14px", color: "#718096" }}>데이터베이스</span>
                  <Badge type="success">정상</Badge>
                </div>
                <div style={{ display: "flex", justifyContent: "space-between", marginBottom: "8px" }}>
                  <span style={{ fontSize: "14px", color: "#718096" }}>캐시 서버</span>
                  <Badge type="warning">주의</Badge>
                </div>
              </div>
            </div>
          </Card>

          <Card title="빠른 작업" variant="elevated">
            <div style={{ display: "flex", flexDirection: "column", gap: "8px" }}>
              <Button variant="primary" fullWidth>
                새 게시글 작성
              </Button>
              <Button variant="secondary" fullWidth>
                사용자 추가
              </Button>
              <Button variant="secondary" fullWidth>
                설정
              </Button>
            </div>
          </Card>
        </div>

        <div
          style={{
            display: "grid",
            gridTemplateColumns: "2fr 1fr",
            gap: "24px",
          }}
        >
          <Card title="최근 게시글" variant="elevated">
            <Table
              data={samplePosts.slice(0, 3)}
              columns={[
                { key: "title", header: "제목" },
                { key: "category", header: "카테고리", width: "120px" },
                { key: "status", header: "상태", width: "100px" },
                { key: "views", header: "조회수", width: "100px" },
              ]}
              entityType="post"
              striped
              hover
            />
          </Card>

          <Card title="알림" variant="elevated">
            <div style={{ display: "flex", flexDirection: "column", gap: "12px" }}>
              <Alert variant="info">시스템 업데이트가 예정되어 있습니다</Alert>
              <Alert variant="warning">임시저장된 게시글이 있습니다</Alert>
            </div>
          </Card>
        </div>
      </main>
    </div>
  ),
  parameters: {
    docs: {
      description: {
        story: "대시보드 페이지 예제입니다. 다양한 위젯과 통계, 최근 활동이 표시됩니다.",
      },
    },
  },
};
